<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js\AvatarWizard.js - Avatar Wizard</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Avatar Wizard"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AvatarWizard.html">AvatarWizard</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js\AvatarWizard.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Manages the composition of a user avatar using predefined graphic parts. This
 * class requires jQuery.
 *
 * The constructor needs to fetch a &#x60;settings.json&#x60; file through AJAX and its
 * methods may not be invoked until this has been done. The user-defined &#x60;ready&#x60;
 * callback is invoked by the &#x60;AvatarWizard&#x60; object when it is ready.
 *
 * @class AvatarWizard
 * @constructor
 * @param canvas Mixed Specifies the HTML5 canvas where the avatar has to be
 * drawn. It can be specified as a HTMLCanvasElement object, string CSS selector
 * or jQuery object.
 * @param ready Function A user-defined callback function invoked after the
 * &#x60;AvatarWizard&#x60; object has read its configuration file and its ready to
 * receive method invocations.
 */
function AvatarWizard(canvas, ready) {
	var thisObject = this;
	$.getJSON(&#x27;settings.json&#x27;, function (settings) {
		var functions = {};

		canvas = $(canvas);
		var context = canvas[0].getContext(&#x27;2d&#x27;);
		var width, height;

		function setDimensions() {
			width = canvas.innerWidth();
			height = canvas.innerHeight();
			canvas.attr({
				width: width,
				height: height
			});
			context.setTransform(1, 0, 0, 1, 0, 0);
			var ratio1 = width / settings.canonicalWidth;
			var ratio2 = height / settings.canonicalHeight;
			if (ratio2 &lt; ratio1) {
				context.translate((width - settings.canonicalWidth * ratio2) / 2, 0);
				context.scale(ratio2, ratio2);
			} else {
				context.translate(0, (height - settings.canonicalHeight * ratio1) / 2);
				context.scale(ratio1, ratio1);
			}
		}

		setDimensions();

		descriptor = {};

		var drawing = false;

		function drawElement(category) {
			if (descriptor.hasOwnProperty(category)) {
				if (typeof descriptor[category] !== &#x27;string&#x27;) {
					functions[category + &#x27;/&#x27; + descriptor[category].type](context, descriptor[category].color);
				} else {
					functions[category + &#x27;/&#x27; + descriptor[category]](context);
				}
				return true;
			} else {
				return false;
			}
		}

		function drawAll() {
			context.save();
			context.setTransform(1, 0, 0, 1, 0, 0);
			context.clearRect(0, 0, width, height);
			context.restore();
			functions.shadow(context);
			drawElement(&#x27;base&#x27;);
			var specialBody = drawElement(&#x27;special_body&#x27;);
			if (!specialBody) {
				drawElement(&#x27;body&#x27;);
			}
			if (!drawElement(&#x27;special_head&#x27;)) {
				drawElement(&#x27;mouth&#x27;);
				drawElement(&#x27;eyes&#x27;);
				drawElement(&#x27;facial_details&#x27;);
				drawElement(&#x27;hair&#x27;);
			}
			if (!specialBody) {
				drawElement(&#x27;accessories&#x27;);
			}
			drawing = false;
		}

		(function (count) {
			function fetchPart(name) {
				count++;
				$.get(&#x27;parts/&#x27; + name + &#x27;.js&#x27;, function (code) {
					eval(code);
					functions[name] = draw;
					if (!--count) {
						drawAll();
						ready();
					}
				}, &#x27;text&#x27;);
			}
			fetchPart(&#x27;shadow&#x27;);
			for (var category in settings.parts) {
				if (settings.parts.hasOwnProperty(category)) {
					settings.parts[category].forEach(function (image) {
						fetchPart(category + &#x27;/&#x27; + image);
					});
				}
			}
		})(0);

		/**
		 * Recalculates the coordinate reference. This method must be invoked
		 * every time the dimensions of the canvas change.
		 *
		 * This method may be called in response to &#x60;resize&#x60; events at a high
		 * rate because the redraw rate is throttled down through
		 * &#x60;requestAnimationFrame&#x60;.
		 *
		 * @method resetDimensions
		 * @chainable
		 */
		thisObject.resetDimensions = function () {
			setDimensions();
			if (!drawing) {
				requestAnimationFrame(drawAll);
			}
			return thisObject;
		};

		/**
		 * TODO
		 *
		 * @method loadAvatar
		 * @chainable
		 * @param newDescriptor Object TODO
		 */
		thisObject.loadAvatar = function (newDescriptor) {
			descriptor = $.extend({}, newDescriptor);
			drawAll();
			return thisObject;
		};

		/**
		 * TODO
		 *
		 * @method getAvatar
		 * @return Object
		 */
		thisObject.getAvatar = function () {
			return $.extend({}, descriptor);
		};

		/**
		 * TODO
		 *
		 * @method select
		 * @chainable
		 * @param category String TODO
		 * @param type String TODO
		 */
		thisObject.select = function (category, type) {
			if (functions.hasOwnProperty(category + &#x27;/&#x27; + type)) {
				if (descriptor.hasOwnProperty(category)) {
					if (typeof descriptor[category] !== &#x27;string&#x27;) {
						descriptor[category].type = type;
					} else {
						descriptor[category] = type;
					}
				} else {
					descriptor[category] = type;
				}
				drawAll();
			} else {
				throw &#x27;Unregistered category or image ID: &quot;&#x27; + category + &#x27;&quot;, &quot;&#x27; + type + &#x27;&quot;&#x27;;
			}
			return thisObject;
		};

		/**
		 * Returns the current color for the specified category.
		 *
		 * This value can be set per-category with the
		 * {{#crossLink &quot;AvatarWizard/setColor&quot;}}setColor{{/crossLink}} method
		 * or in the avatar descriptor specified to the
		 * {{#crossLink &quot;AvatarWizard/loadAvatar&quot;}}loadAvatar{{/crossLink}}
		 * method.
		 *
		 * The return value is undefined if no color has been set.
		 *
		 * @method getColor
		 * @param category String The category to set the color for.
		 * @return String The current CSS color for the specified category, or
		 * &#x60;undefined&#x60; if no color is set.
		 */
		thisObject.getColor = function (category) {
			if (descriptor.hasOwnProperty(category)) {
				if (typeof descriptor[category] !== &#x27;string&#x27;) {
					return descriptor[category].color;
				}
			}
		};

		/**
		 * TODO
		 *
		 * @method setColor
		 * @chainable
		 * @param category String TODO
		 * @param color String TODO
		 */
		thisObject.setColor = function (category, color) {
			if (descriptor.hasOwnProperty(category)) {
				if (typeof descriptor[category] !== &#x27;string&#x27;) {
					descriptor[category].color = color;
				} else {
					descriptor[category] = {
						type: descriptor[category],
						color: color
					};
				}
			}
			if (!drawing) {
				requestAnimationFrame(drawAll);
			}
			return thisObject;
		};

		function getThumbnail(width, height) {
			// TODO
		}

		/**
		 * TODO
		 *
		 * @method getThumbnail
		 * @param width Number TODO
		 * @param height Number TODO
		 * @return HTMLElement TODO
		 */
		thisObject.getThumbnail = getThumbnail;

		/**
		 * TODO
		 *
		 * @method getEncodedThumbnail
		 * @param width Number TODO
		 * @param height Number TODO
		 * @return String TODO
		 */
		thisObject.getEncodedThumbnail = function (width, height) {
			return getThumbnail(width, height).toDataURL(&#x27;image/png&#x27;);
		};
	});
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
